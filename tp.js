/*************************************************
 * 
 * 0Konstanten managen
 * 
 ***************************************************/
const dasJahr = "2018"

const versicherungsvertragABI = [
 
  {
    "constant": true,
    "inputs": [],
    "name": "laufzeit",
    "outputs": [
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "name": "transporte",
    "outputs": [
      {
        "name": "",
        "type": "address"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "status",
    "outputs": [
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "versicherer",
    "outputs": [
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "erstellungsdatum",
    "outputs": [
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "beginn",
    "outputs": [
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "summe",
    "outputs": [
      {
        "name": "",
        "type": "int256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "tarif",
    "outputs": [
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "id",
    "outputs": [
      {
        "name": "",
        "type": "bytes8"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "nr",
    "outputs": [
      {
        "name": "",
        "type": "int256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "ende",
    "outputs": [
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "versicherungsnehmer",
    "outputs": [
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [
      {
        "name": "kp",
        "type": "address"
      },
      {
        "name": "vn",
        "type": "string"
      },
      {
        "name": "vu",
        "type": "string"
      },
      {
        "name": "tar",
        "type": "string"
      },
      {
        "name": "vnr",
        "type": "int256"
      },
      {
        "name": "sum",
        "type": "int256"
      }
    ],
    "payable": true,
    "stateMutability": "payable",
    "type": "constructor"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "gibTransportAnzahl",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "transport",
        "type": "address"
      }
    ],
    "name": "ergaenzeTransport",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "ermittleSchadenshoehe",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "lz",
        "type": "string"
      },
      {
        "name": "bg",
        "type": "string"
      },
      {
        "name": "ed",
        "type": "string"
      }
    ],
    "name": "aendereLaufzeit",
    "outputs": [],
    "payable": true,
    "stateMutability": "payable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [],
    "name": "beendeVertrag",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [],
    "name": "starteVertrag",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "gibSchadenDetails",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "gibID",
    "outputs": [
      {
        "name": "",
        "type": "bytes8"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "gibDetails",
    "outputs": [
      {
        "name": "",
        "type": "bytes8"
      },
      {
        "name": "",
        "type": "string"
      },
      {
        "name": "",
        "type": "string"
      },
      {
        "name": "",
        "type": "string"
      },
      {
        "name": "",
        "type": "int256"
      },
      {
        "name": "",
        "type": "string"
      },
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "index",
        "type": "uint256"
      }
    ],
    "name": "gibTransport",
    "outputs": [
      {
        "name": "",
        "type": "address"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "vn",
        "type": "string"
      },
      {
        "name": "vu",
        "type": "string"
      },
      {
        "name": "tar",
        "type": "string"
      },
      {
        "name": "vnr",
        "type": "int256"
      },
      {
        "name": "sum",
        "type": "int256"
      }
    ],
    "name": "aendereVertrag",
    "outputs": [],
    "payable": true,
    "stateMutability": "payable",
    "type": "function"
  } 
];


const transportbytecode = "0x60806040523480156200001157600080fd5b506040516200347038038062003470833981018060405260608110156200003757600080fd5b8101908080516401000000008111156200005057600080fd5b828101905060208101848111156200006757600080fd5b81518560018202830111640100000000821117156200008557600080fd5b50509291906020018051640100000000811115620000a257600080fd5b82810190506020810184811115620000b957600080fd5b8151856001820283011164010000000082111715620000d757600080fd5b50509291906020018051640100000000811115620000f457600080fd5b828101905060208101848111156200010b57600080fd5b81518560018202830111640100000000821117156200012957600080fd5b50509291905050507f746f646f000000000000000000000000000000000000000000000000000000006000806101000a81548167ffffffffffffffff02191690837801000000000000000000000000000000000000000000000000900402179055508260039080519060200190620001a39291906200028b565b508160049080519060200190620001bc9291906200028b565b508060059080519060200190620001d59291906200028b565b506040805190810160405280600781526020017f6765706c616e740000000000000000000000000000000000000000000000000081525060099080519060200190620002239291906200028b565b506040805190810160405280600a81526020017f30312e30312e323031380000000000000000000000000000000000000000000081525060029080519060200190620002719291906200028b565b5060006010819055506000600f819055505050506200033a565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10620002ce57805160ff1916838001178555620002ff565b82800160010185558215620002ff579182015b82811115620002fe578251825591602001919060010190620002e1565b5b5090506200030e919062000312565b5090565b6200033791905b808211156200033357600081600090555060010162000319565b5090565b90565b613126806200034a6000396000f3fe60806040526004361061016a576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063169a01a11461016f5780631a519ec4146101ff5780631a5ffb0c1461028f5780631d5d56c31461031f57806321daaca91461051e5780632ab8d1b9146105ae5780632be26eb714610631578063301bd28e146108275780634243e952146108b757806373970d9c1461097f5780637d9699b614610a0f57806381ffe26d14610a3a5780639167e49814610aca57806397d3b22b14610af55780639bde548714610c5e578063a0f4881714610c89578063a18a963f14610d19578063a913fbcd14610d9c578063af640d0f14611045578063b0b5299a146110a6578063bb8cb6da14611129578063c7a477b714611154578063daba7a661461136c578063dce80d2214611596578063dd25974b146115c1578063ddbe2c6414611651578063eea3a7731461167f578063f91748221461170f575b600080fd5b34801561017b57600080fd5b5061018461173a565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156101c45780820151818401526020810190506101a9565b50505050905090810190601f1680156101f15780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561020b57600080fd5b506102146117d8565b6040518080602001828103825283818151815260200191508051906020019080838360005b83811015610254578082015181840152602081019050610239565b50505050905090810190601f1680156102815780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561029b57600080fd5b506102a4611876565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156102e45780820151818401526020810190506102c9565b50505050905090810190601f1680156103115780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561032b57600080fd5b506103586004803603602081101561034257600080fd5b8101908080359060200190929190505050611914565b604051808060200180602001806020018060200186815260200185810385528a818151815260200191508051906020019080838360005b838110156103aa57808201518184015260208101905061038f565b50505050905090810190601f1680156103d75780820380516001836020036101000a031916815260200191505b50858103845289818151815260200191508051906020019080838360005b838110156104105780820151818401526020810190506103f5565b50505050905090810190601f16801561043d5780820380516001836020036101000a031916815260200191505b50858103835288818151815260200191508051906020019080838360005b8381101561047657808201518184015260208101905061045b565b50505050905090810190601f1680156104a35780820380516001836020036101000a031916815260200191505b50858103825287818151815260200191508051906020019080838360005b838110156104dc5780820151818401526020810190506104c1565b50505050905090810190601f1680156105095780820380516001836020036101000a031916815260200191505b50995050505050505050505060405180910390f35b34801561052a57600080fd5b50610533611c79565b6040518080602001828103825283818151815260200191508051906020019080838360005b83811015610573578082015181840152602081019050610558565b50505050905090810190601f1680156105a05780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6105b6611d17565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156105f65780820151818401526020810190506105db565b50505050905090810190601f1680156106235780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561063d57600080fd5b506108256004803603606081101561065457600080fd5b810190808035906020019064010000000081111561067157600080fd5b82018360208201111561068357600080fd5b803590602001918460018302840111640100000000831117156106a557600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505091929192908035906020019064010000000081111561070857600080fd5b82018360208201111561071a57600080fd5b8035906020019184600183028401116401000000008311171561073c57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505091929192908035906020019064010000000081111561079f57600080fd5b8201836020820111156107b157600080fd5b803590602001918460018302840111640100000000831117156107d357600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050611e05565b005b34801561083357600080fd5b5061083c611e4f565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561087c578082015181840152602081019050610861565b50505050905090810190601f1680156108a95780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b3480156108c357600080fd5b5061097d600480360360208110156108da57600080fd5b81019080803590602001906401000000008111156108f757600080fd5b82018360208201111561090957600080fd5b8035906020019184600183028401116401000000008311171561092b57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050611eed565b005b34801561098b57600080fd5b50610994611f07565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156109d45780820151818401526020810190506109b9565b50505050905090810190601f168015610a015780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b348015610a1b57600080fd5b50610a24611fa5565b6040518082815260200191505060405180910390f35b348015610a4657600080fd5b50610a4f611fab565b6040518080602001828103825283818151815260200191508051906020019080838360005b83811015610a8f578082015181840152602081019050610a74565b50505050905090810190601f168015610abc5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b348015610ad657600080fd5b50610adf61204d565b6040518082815260200191505060405180910390f35b348015610b0157600080fd5b50610c5c60048036036060811015610b1857600080fd5b810190808035906020019092919080359060200190640100000000811115610b3f57600080fd5b820183602082011115610b5157600080fd5b80359060200191846001830284011164010000000083111715610b7357600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050919291929080359060200190640100000000811115610bd657600080fd5b820183602082011115610be857600080fd5b80359060200191846001830284011164010000000083111715610c0a57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050612053565b005b348015610c6a57600080fd5b50610c7361208d565b6040518082815260200191505060405180910390f35b348015610c9557600080fd5b50610c9e612097565b6040518080602001828103825283818151815260200191508051906020019080838360005b83811015610cde578082015181840152602081019050610cc3565b50505050905090810190601f168015610d0b5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b610d21612135565b6040518080602001828103825283818151815260200191508051906020019080838360005b83811015610d61578082015181840152602081019050610d46565b50505050905090810190601f168015610d8e5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b348015610da857600080fd5b50611043600480360360a0811015610dbf57600080fd5b8101908080359060200190640100000000811115610ddc57600080fd5b820183602082011115610dee57600080fd5b80359060200191846001830284011164010000000083111715610e1057600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050919291929080359060200190640100000000811115610e7357600080fd5b820183602082011115610e8557600080fd5b80359060200191846001830284011164010000000083111715610ea757600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050919291929080359060200190640100000000811115610f0a57600080fd5b820183602082011115610f1c57600080fd5b80359060200191846001830284011164010000000083111715610f3e57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050919291929080359060200190640100000000811115610fa157600080fd5b820183602082011115610fb357600080fd5b80359060200191846001830284011164010000000083111715610fd557600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050919291929080356fffffffffffffffffffffffffffffffff169060200190929190505050612223565b005b34801561105157600080fd5b5061105a612384565b604051808277ffffffffffffffffffffffffffffffffffffffffffffffff191677ffffffffffffffffffffffffffffffffffffffffffffffff1916815260200191505060405180910390f35b6110ae6123ae565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156110ee5780820151818401526020810190506110d3565b50505050905090810190601f16801561111b5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561113557600080fd5b5061113e61253f565b6040518082815260200191505060405180910390f35b34801561116057600080fd5b5061116961254c565b604051808777ffffffffffffffffffffffffffffffffffffffffffffffff191677ffffffffffffffffffffffffffffffffffffffffffffffff191681526020018060200180602001806020018060200186815260200185810385528a818151815260200191508051906020019080838360005b838110156111f75780820151818401526020810190506111dc565b50505050905090810190601f1680156112245780820380516001836020036101000a031916815260200191505b50858103845289818151815260200191508051906020019080838360005b8381101561125d578082015181840152602081019050611242565b50505050905090810190601f16801561128a5780820380516001836020036101000a031916815260200191505b50858103835288818151815260200191508051906020019080838360005b838110156112c35780820151818401526020810190506112a8565b50505050905090810190601f1680156112f05780820380516001836020036101000a031916815260200191505b50858103825287818151815260200191508051906020019080838360005b8381101561132957808201518184015260208101905061130e565b50505050905090810190601f1680156113565780820380516001836020036101000a031916815260200191505b509a505050505050505050505060405180910390f35b34801561137857600080fd5b506113a56004803603602081101561138f57600080fd5b810190808035906020019092919050505061280c565b6040518087815260200180602001806020018060200180602001866fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff16815260200185810385528a818151815260200191508051906020019080838360005b83811015611421578082015181840152602081019050611406565b50505050905090810190601f16801561144e5780820380516001836020036101000a031916815260200191505b50858103845289818151815260200191508051906020019080838360005b8381101561148757808201518184015260208101905061146c565b50505050905090810190601f1680156114b45780820380516001836020036101000a031916815260200191505b50858103835288818151815260200191508051906020019080838360005b838110156114ed5780820151818401526020810190506114d2565b50505050905090810190601f16801561151a5780820380516001836020036101000a031916815260200191505b50858103825287818151815260200191508051906020019080838360005b83811015611553578082015181840152602081019050611538565b50505050905090810190601f1680156115805780820380516001836020036101000a031916815260200191505b509a505050505050505050505060405180910390f35b3480156115a257600080fd5b506115ab612ad3565b6040518082815260200191505060405180910390f35b3480156115cd57600080fd5b506115d6612e40565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156116165780820151818401526020810190506115fb565b50505050905090810190601f1680156116435780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b61167d6004803603602081101561166757600080fd5b8101908080359060200190929190505050612ede565b005b34801561168b57600080fd5b50611694612ee8565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156116d45780820151818401526020810190506116b9565b50505050905090810190601f1680156117015780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561171b57600080fd5b50611724612f86565b6040518082815260200191505060405180910390f35b600c8054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156117d05780601f106117a5576101008083540402835291602001916117d0565b820191906000526020600020905b8154815290600101906020018083116117b357829003601f168201915b505050505081565b60068054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561186e5780601f106118435761010080835404028352916020019161186e565b820191906000526020600020905b81548152906001019060200180831161185157829003601f168201915b505050505081565b60088054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561190c5780601f106118e15761010080835404028352916020019161190c565b820191906000526020600020905b8154815290600101906020018083116118ef57829003601f168201915b505050505081565b6060806060806000611924612f8c565b600a8781548110151561193357fe5b906000526020600020906006020160c0604051908101604052908160008201548152602001600182018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156119f05780601f106119c5576101008083540402835291602001916119f0565b820191906000526020600020905b8154815290600101906020018083116119d357829003601f168201915b50505050508152602001600282018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611a925780601f10611a6757610100808354040283529160200191611a92565b820191906000526020600020905b815481529060010190602001808311611a7557829003601f168201915b50505050508152602001600382018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611b345780601f10611b0957610100808354040283529160200191611b34565b820191906000526020600020905b815481529060010190602001808311611b1757829003601f168201915b50505050508152602001600482018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611bd65780601f10611bab57610100808354040283529160200191611bd6565b820191906000526020600020905b815481529060010190602001808311611bb957829003601f168201915b505050505081526020016005820160009054906101000a90046fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff1681525050905080602001518160400151826060015183608001518460a00151849450839350829250819150806fffffffffffffffffffffffffffffffff169050955095509550955095505091939590929450565b60038054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611d0f5780601f10611ce457610100808354040283529160200191611d0f565b820191906000526020600020905b815481529060010190602001808311611cf257829003601f168201915b505050505081565b60606040805190810160405280600781526020017f6c617566656e640000000000000000000000000000000000000000000000000081525060099080519060200190611d64929190612fd5565b5060098054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611dfb5780601f10611dd057610100808354040283529160200191611dfb565b820191906000526020600020905b815481529060010190602001808311611dde57829003601f168201915b5050505050905090565b8260069080519060200190611e1b929190612fd5565b508160089080519060200190611e32929190612fd5565b508060079080519060200190611e49929190612fd5565b50505050565b600d8054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611ee55780601f10611eba57610100808354040283529160200191611ee5565b820191906000526020600020905b815481529060010190602001808311611ec857829003601f168201915b505050505081565b8060019080519060200190611f03929190612fd5565b5050565b60018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611f9d5780601f10611f7257610100808354040283529160200191611f9d565b820191906000526020600020905b815481529060010190602001808311611f8057829003601f168201915b505050505081565b600f5481565b606060028054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156120435780601f1061201857610100808354040283529160200191612043565b820191906000526020600020905b81548152906001019060200180831161202657829003601f168201915b5050505050905090565b600b5481565b82600b8190555081600c9080519060200190612070929190612fd5565b5080600d9080519060200190612087929190612fd5565b50505050565b6000601054905090565b60048054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561212d5780601f106121025761010080835404028352916020019161212d565b820191906000526020600020905b81548152906001019060200180831161211057829003601f168201915b505050505081565b60606040805190810160405280600b81526020017f61626765726563686e657400000000000000000000000000000000000000000081525060099080519060200190612182929190612fd5565b5060098054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156122195780601f106121ee57610100808354040283529160200191612219565b820191906000526020600020905b8154815290600101906020018083116121fc57829003601f168201915b5050505050905090565b61222b612f8c565b600a80549050816000018181525050858160200181905250848160400181905250838160600181905250828160800181905250818160a001906fffffffffffffffffffffffffffffffff1690816fffffffffffffffffffffffffffffffff1681525050600a81908060018154018082558091505090600182039060005260206000209060060201600090919290919091506000820151816000015560208201518160010190805190602001906122e2929190613055565b5060408201518160020190805190602001906122ff929190613055565b50606082015181600301908051906020019061231c929190613055565b506080820151816004019080519060200190612339929190613055565b5060a08201518160050160006101000a8154816fffffffffffffffffffffffffffffffff02191690836fffffffffffffffffffffffffffffffff160217905550505050505050505050565b6000809054906101000a900478010000000000000000000000000000000000000000000000000281565b60603073ffffffffffffffffffffffffffffffffffffffff1663dce80d226040518163ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040160206040518083038186803b15801561241257600080fd5b505afa158015612426573d6000803e3d6000fd5b505050506040513d602081101561243c57600080fd5b81019080805190602001909291905050506010819055506040805190810160405280600681526020017f66657274696700000000000000000000000000000000000000000000000000008152506009908051906020019061249e929190612fd5565b5060098054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156125355780601f1061250a57610100808354040283529160200191612535565b820191906000526020600020905b81548152906001019060200180831161251857829003601f168201915b5050505050905090565b6000600a80549050905090565b600060608060608060008060009054906101000a90047801000000000000000000000000000000000000000000000000026001600360056009600f54848054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561261d5780601f106125f25761010080835404028352916020019161261d565b820191906000526020600020905b81548152906001019060200180831161260057829003601f168201915b50505050509450838054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156126b95780601f1061268e576101008083540402835291602001916126b9565b820191906000526020600020905b81548152906001019060200180831161269c57829003601f168201915b50505050509350828054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156127555780601f1061272a57610100808354040283529160200191612755565b820191906000526020600020905b81548152906001019060200180831161273857829003601f168201915b50505050509250818054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156127f15780601f106127c6576101008083540402835291602001916127f1565b820191906000526020600020905b8154815290600101906020018083116127d457829003601f168201915b50505050509150955095509550955095509550909192939495565b600a8181548110151561281b57fe5b9060005260206000209060060201600091509050806000015490806001018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156128cd5780601f106128a2576101008083540402835291602001916128cd565b820191906000526020600020905b8154815290600101906020018083116128b057829003601f168201915b505050505090806002018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561296b5780601f106129405761010080835404028352916020019161296b565b820191906000526020600020905b81548152906001019060200180831161294e57829003601f168201915b505050505090806003018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612a095780601f106129de57610100808354040283529160200191612a09565b820191906000526020600020905b8154815290600101906020018083116129ec57829003601f168201915b505050505090806004018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612aa75780601f10612a7c57610100808354040283529160200191612aa7565b820191906000526020600020905b815481529060010190602001808311612a8a57829003601f168201915b5050505050908060050160009054906101000a90046fffffffffffffffffffffffffffffffff16905086565b60008060009050600080905060008090506000600a805490509050600091505b80821015612e3657612b03612f8c565b600a83815481101515612b1257fe5b906000526020600020906006020160c0604051908101604052908160008201548152602001600182018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612bcf5780601f10612ba457610100808354040283529160200191612bcf565b820191906000526020600020905b815481529060010190602001808311612bb257829003601f168201915b50505050508152602001600282018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612c715780601f10612c4657610100808354040283529160200191612c71565b820191906000526020600020905b815481529060010190602001808311612c5457829003601f168201915b50505050508152602001600382018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612d135780601f10612ce857610100808354040283529160200191612d13565b820191906000526020600020905b815481529060010190602001808311612cf657829003601f168201915b50505050508152602001600482018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612db55780601f10612d8a57610100808354040283529160200191612db5565b820191906000526020600020905b815481529060010190602001808311612d9857829003601f168201915b505050505081526020016005820160009054906101000a90046fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff168152505090508060a001516fffffffffffffffffffffffffffffffff1693508484019450508180600101925050612af3565b8394505050505090565b60078054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612ed65780601f10612eab57610100808354040283529160200191612ed6565b820191906000526020600020905b815481529060010190602001808311612eb957829003601f168201915b505050505081565b80600f8190555050565b60058054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612f7e5780601f10612f5357610100808354040283529160200191612f7e565b820191906000526020600020905b815481529060010190602001808311612f6157829003601f168201915b505050505081565b60105481565b60c060405190810160405280600081526020016060815260200160608152602001606081526020016060815260200160006fffffffffffffffffffffffffffffffff1681525090565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061301657805160ff1916838001178555613044565b82800160010185558215613044579182015b82811115613043578251825591602001919060010190613028565b5b50905061305191906130d5565b5090565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061309657805160ff19168380011785556130c4565b828001600101855582156130c4579182015b828111156130c35782518255916020019190600101906130a8565b5b5090506130d191906130d5565b5090565b6130f791905b808211156130f35760008160009055506001016130db565b5090565b9056fea165627a7a723058204d91cef4289a9c9c939aac71d863554b3b0b25ecba5b544bc2ee9cca6386b0c00029";
const transportABI = [

  {
    "constant": true,
    "inputs": [],
    "name": "einheit",
    "outputs": [
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "AnName",
    "outputs": [
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "AnDatum",
    "outputs": [
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "VonName",
    "outputs": [
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "art",
    "outputs": [
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "spedition",
    "outputs": [
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "warenwert",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "menge",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "VonDatum",
    "outputs": [
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "id",
    "outputs": [
      {
        "name": "",
        "type": "bytes8"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "name": "uebergaben",
    "outputs": [
      {
        "name": "nr",
        "type": "uint256"
      },
      {
        "name": "datum",
        "type": "string"
      },
      {
        "name": "ort",
        "type": "string"
      },
      {
        "name": "menge",
        "type": "string"
      },
      {
        "name": "frachtfuehrer",
        "type": "string"
      },
      {
        "name": "schaden",
        "type": "uint128"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "AnOrt",
    "outputs": [
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "VonOrt",
    "outputs": [
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "schadenhoehe",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [
      {
        "name": "vn",
        "type": "string"
      },
      {
        "name": "vd",
        "type": "string"
      },
      {
        "name": "va",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "constructor"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "gibDetails",
    "outputs": [
      {
        "name": "",
        "type": "bytes8"
      },
      {
        "name": "",
        "type": "string"
      },
      {
        "name": "",
        "type": "string"
      },
      {
        "name": "",
        "type": "string"
      },
      {
        "name": "",
        "type": "string"
      },
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "sp",
        "type": "string"
      }
    ],
    "name": "ergaenzeSpedition",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "an",
        "type": "string"
      },
      {
        "name": "ad",
        "type": "string"
      },
      {
        "name": "ao",
        "type": "string"
      }
    ],
    "name": "ergaenzeAdresssat",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "mg",
        "type": "uint256"
      },
      {
        "name": "eh",
        "type": "string"
      },
      {
        "name": "ar",
        "type": "string"
      }
    ],
    "name": "ergaenzeDetails",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "dt",
        "type": "string"
      },
      {
        "name": "ot",
        "type": "string"
      },
      {
        "name": "mg",
        "type": "string"
      },
      {
        "name": "ff",
        "type": "string"
      },
      {
        "name": "sd",
        "type": "uint128"
      }
    ],
    "name": "ergaenzeUebergabe",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "index",
        "type": "uint256"
      }
    ],
    "name": "gibUebergabe",
    "outputs": [
      {
        "name": "dt",
        "type": "string"
      },
      {
        "name": "ot",
        "type": "string"
      },
      {
        "name": "mg",
        "type": "string"
      },
      {
        "name": "ff",
        "type": "string"
      },
      {
        "name": "sd",
        "type": "int256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "wert",
        "type": "uint256"
      }
    ],
    "name": "aendereWarenwert",
    "outputs": [],
    "payable": true,
    "stateMutability": "payable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [],
    "name": "starteTransport",
    "outputs": [
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": true,
    "stateMutability": "payable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [],
    "name": "beendeTransport",
    "outputs": [
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": true,
    "stateMutability": "payable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [],
    "name": "abrechnenTransport",
    "outputs": [
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": true,
    "stateMutability": "payable",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "gibStartdatum",
    "outputs": [
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "gibRoutenAnzahl",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "gibTransportSchaden",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "gibSchadenhoehe",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  }


];



function anzeigenRouten(data,contract){

  console.log("Routen lesen... " + data );

  var anzahl = contract.uebergaben.length;

    t="0";
    console.log("Adresse: " + contract.address); 

    try {

      t="2";

      /*contract.gibRoutenAnzahl((error, value) => {
        if (error) { console.error(error); }
        data.anzahlRouten = value;
        anzahl = value;
      });
      console.log("step" + t);*/

      for (let index = 0; index < anzahl; index++) {

        var uebergabe =  contract.gibUebergabe (index);
        data.rtAbfahrt = uebergabe[0];
        data.rtAdresse = uebergabe[1];
        data.rtMenge = uebergabe[2];
        data.rtVon = uebergabe[3];
        data.rtSchaden = uebergabe[4];

/*
        public view returns (string memory dt, string memory ot, string memory mg,string memory ff,int  sd) {
          uebergabe memory eineUebergabe;
          eineUebergabe = uebergaben[index];
          return (eineUebergabe.datum, eineUebergabe.ort,eineUebergabe.menge,eineUebergabe.frachtfuehrer,eineUebergabe.schaden);
      }*/
        
      }
    }
  catch (error){
      console.log("Fehler bei der Route: " + i + "-" + error);
    }
}



/*************************************************
 * 
 * 
 * 0Versicherungsvertrag managen
 * 
 * 
 ***************************************************/
function sucheVersicherungsvertrag(data)  {

  console.log("Versicherungsvertrag suchen ..." + data.derVersicherungsvertragAdresse);

  //Anhang der Adresse den Kooperationsvertrag suchen
  var myContract = web3.eth.contract(versicherungsvertragABI);
  var contract = myContract.at(data.derVersicherungsvertragAdresse);
  data.derVersicherungsvertrag = contract;

  contract.id((error, value) => {
    if (error) { console.error("fehlerchen: " + error); }
    if (!error) {
      data.derVersicherungsvertragName = value;
    }
  });

  contract.gibTransportAnzahl((error, value) => {
    if (error) {console.error(error);}
    data.anzahlTransporte=value;
  });
  console.log("Versicherungsvertrag (noch nicht?) gefunden!");

}




/*************************************************
 * 
 * 
 * 1Transporte managen
 * 
 * 
 ***************************************************/
function sucheTransporte(data) {

  console.log("Transporte finden..." + data.derVersicherungsvertrag);

 

  try {

    //parameter übernehmen
    data.transporte=new Array();
    anzahl=data.anzahlTransporte;
    

    for (let i = 0; i < anzahl; i++) {
         console.log(i + ". Transport von " + anzahl);

      //vertrag holen
      data.derVersicherungsvertrag.gibTransport(i,(error,value) => {
        if (error) {console.error("Fehler beim " + i + "Transport:" + error);}
        if (!error) {
  
          console.log("Transportadresse:" + value);
          var contractDesc = web3.eth.contract(transportABI);
          var contract = contractDesc.at(value); // "Cast"

          //Daten holen
          contract.gibDetails((error, value) => {
            if (error) {console.error("Fehler beim " + i + "Transport:" + error);}
            else {
    
              try {
                
                console.log("Details: " + value);  

                //liste aktualisieren
                data.transporte.push (
                    {id : value[0],
                    spedition : value[1],
                    absender : value[2],
                    von : value[3],
                    status : value[4],
                    warenwert : value[5],
                    adresse: contract.address}
                    );

              } catch (error) {

                console.log("Fehler bei Details: " + i);
              }
                          };
          });
        }
      });
    }

  }
  catch (error)
  {
    console.log("Fehler beim Lesen der Transporte : " + error);
  }

}

function meldenSchaden(data) {


    console.log("Transport aendern ... " + data );
    var s;
  
    try {
  
  
      //
      var myContract = web3.eth.contract(transportABI);
      var myContractInstance = myContract.at(data.derTransportAdresse);
  
      myContractInstance.beendeTransport (
        {from : bcManager, value: gebuehr0, gas: fgDefaultGas},
        function(err, result){
          if(!err) {
            // NOTE: The callback will fire twice!
            // Once the contract has the transactionHash property set and once its deployed on an address.
             // e.g. check tx hash on the first call (transaction send)
            if(!myContract.address) {
                console.log("Phase1- " + myContract.transactionHash) // The hash of the transaction, which deploys the contract
  
            // check address on the second call (contract deployed)
            } else {
                console.log("Phase2- " + myContract.address) // the contract address
                s = "<<<< Transport beendet - Schäden aktualisiert";
                data.Systeminfo=s;
                console.log(s)
            }
             // Note that the returned "myContractReturned" === "myContract",
            // so the returned "myContractReturned" object will also get the address set.
         }
         else {
          s = "<<<< Fehler beim Transport beenden";
          data.Systeminfo=s;
          console.log(s+ err);
  
         }
        });
  
        s = "<<<< Fehler beim Transport beenden";
        data.Systeminfo=s;
  
  
    } catch (error) {
      s = "<<<< Fehler beim Transport beenden";
      data.Systeminfo=s;
      console.log(s+ err);
  
    }
  
  

}


function anzeigenTransport(data){

  console.log("Transport anzeigen... " + data.tpAdresse );

    var anzahl=0;

    //web3 = new Web3(web3.currentProvider);
    //var contractDesc = web3.eth.contract(kooperationABI);
    //var contract = contractDesc.at(kooperationContractADR); // "Cast"

    var contractDesc = web3.eth.contract(transportABI);
    var contract = contractDesc.at(data.tpAdresse); 


    t="0";
    data.derTransport = contract;
    data.derTransportAdresse = contract.address;
    //data.tpAdresse = contract.address; 

    //kooperationContractADR;
    //data.Systeminfo= kooperationABI + "/" + kooperationContractADR + "/" + contractDesc.adresse + "/"+ contract.adresse;
    console.log("step:" + t );


    
    try {

      t="a";
      contract.spedition((error, value) => {
        if (error) { console.error(error); }
        data.tpSpedition = value;
      });
      console.log("step:" + t);

      t="b";
      contract.id((error, value) => {
        if (error) { console.error(error); }
        data.tpIdentifikation = value;
      });
      console.log("step:" + t);

      t="c";
      contract.warenwert((error, value) => {
        if (error) { console.error(error); }
        data.tpWarenwert = value;
      });
      console.log("step:" + t);

      t="1";
      contract.VonName((error, value) => {
        if (error) { console.error(error); }
        data.tpAbsenderName= value;
      });
      console.log("step:" + t);

      t="2";
      contract.VonDatum((error, value) => {
        if (error) { console.error(error); }
        data.tpAbsenderDatum = value;
      });
      console.log("step:" + t);


      t="3";
      contract.VonOrt((error, value) => {
        if (error) { console.error(error); }
        data.tpAbsenderOrt = value;
      });
      console.log("step:" + t);
 
      
      t="4";
      contract.AnName((error, value) => {
        if (error) { console.error(error); }
        data.tpAdressatName = value;
      });
      console.log("step:" + t);

      t="5";
      contract.AnDatum((error, value) => {
        if (error) { console.error(error); }
        data.tpAdressatDatum = value;
      });
      console.log("step:" + t);

      t="6";
      contract.AnOrt((error, value) => {
        if (error) { console.error(error); }
        data.tpAdressatOrt = value;
      });
      console.log("step:" + t);
 
      t="7";
      contract.menge((error, value) => {
        if (error) { console.error(error); }
        data.tpMenge = value.toString();
      });
      console.log("step:" + t);

      
      t="8";
      contract.einheit((error, value) => {
        if (error) { console.error(error); }
        data.tpEinheit = value;
      });
      console.log("step:" + t);

      t="9";
      contract.art((error, value) => {
        if (error) { console.error(error); }
        data.tpArt = value;
      });
      console.log("step" + t);

      t="10";
      contract.schadenhoehe((error, value) => {
        if (error) { console.error(error); }
        data.tpSchaeden = value;
      });
      console.log("step" + t);

      t="20";
      contract.gibRoutenAnzahl((error, value) => {
        if (error) { console.error(error); }
        data.anzahlRouten = value;
      });
      console.log("step" + t);

      t="21";
      //anzeigenRouten(data,contract);
      var anzahlRouten = contract.uebergaben.length;
      for (let index = 0; index < anzahlRouten; index++) {

        var uebergabe =  contract.gibUebergabe (index);
        data.rtAbfahrt = uebergabe[0];
        data.rtAdresse = uebergabe[1];
        data.rtMenge = uebergabe[2];
        data.rtVon = uebergabe[3];
        data.rtSchaden = uebergabe[4];
        
      }


    } catch (error) {

      console.log("Fehler beim Transport lesen:" + error);


    }


    //
    // Konto und -stand des Masters ermitteln
    //

    console.log("Transprt gelesen bis Schritt : " + t );

}


function transportStatus() {

  console.log("transport ändern... "  );

    const contractDesc = web3.eth.contract(transportABI);
    var contract = contractDesc.at(data.derTransport);

    contract.abrechnenTransport(
      {
      data: transportbytecode,
      gas: 1000000
    }, function(error, contract) {
      console.log(contract)
    });

    console.log("transport gespeichert : " + contractDesc );

  }



function transportSpeichern(id) {

  console.log("transport speichern... " + id );

    const contractDesc = web3.eth.contract(transportABI);
    contractDesc.new(id, {
      data: transportbytecode,
      gas: 1000000
    }, function(error, contract) {
      console.log(contract)
    });

    console.log("transport gespeichert : " + contractDesc );

  }

  /*
function loadTransporte(data) {
  const contractDesc = web3.eth.contract(versicherungsvertragAbi);
  const transportContractDesc = web3.eth.contract(transportAbi);
  const contract = contractDesc.at(contractAddress); // "Cast"
  contract.getTransporteLength((error, value) => {
      if (error) { console.error(error); }
      data.tmp = value.toString();
      const anzTransporte = value.toNumber();
      for (let i = 0; i < anzTransporte; i++) {
          contract.transporte(i, (error, transport) => {
              const transportContract = transportContractDesc.at(transport);
              transportContract.id((error, value) => {
                  data.transporte.push({id: value.toNumber(), address: transport, index: i});
              });
          });
      }
  });
}
function transportAnlegen(transportId) {
  const contractDesc = web3.eth.contract(versicherungsvertragAbi);
  const versicherungsContract = contractDesc.at(contractAddress);
  versicherungsContract.addTransport(transportId, {value: 0, gas: 1000000}, (error, transactionHash) => {
    console.log(transactionHash);
  });
}*/

function transportAbrechnen (data) {

  console.log("bin beim transport abrechnen : ");
  console.log(data);

  var sender = bcVersicherung;
  var receiver = bcSpedition;
  //var schadenhoehe =gibSchadenhoehe
  var amount = web3.toWei(0.01, "ether")


  web3.eth.sendTransaction({from:sender, to:receiver, value: amount},(error, value) => {
    if (error) { console.error(error); }
    if (!error) {
      
      data.Systeminfo=">>>> Transport abgerechnet ";
      console.log("Transport abgerechnet : " + data); 
      //transportStatus();
    }
  });



    
}





function transportAnlegen (data) {

  console.log("bin beim transport anlegen: ");
  console.log(data);

  //Vorbedingungen prüfen
  var vorbedingungen=0;
  if (data.tpAbsender=="") {vorbedingungen=1}
  if (data.tpSpedition=="") {vorbedingungen=2}
  if  (data.tpVertrag==null) {vorbedingungen=3}
  if (vorbedingungen>0) {
    data.Systeminfo="Fehler " + vorbedingungen + " Transport anlegen";
    return;
  }

  else {

  //Werte initialisieren
  var eineNummer = Math.round(Math.random() * (3000 - 1)) + 1;
  var id = "T-" + eineNummer.toString();
  var einTag = Math.round(Math.random() * (24 - 1)) + 1;
  var einMonat = Math.round(Math.random() * (12 - 1)) + 1;
  var dasDatum = einTag+"."+einMonat+"."+dasJahr; 

  //Transport in die Liste schreiben
  data.transporte.push({
    spedition : data.tpSpedition,
    absender: data.tpAbsender,
    id : id ,
    warenwert: data.tpWarenwert,
    datum: data.tpDatum,
    ziel: data.tpZiel, 
    schaeden : 0,
    routen : new Array(),
    adresse: data.addr}); 

  data.anzahlTransporte=data.transporte.length; //data.versicherungsvertraege.length;
  data.derTransport = data.transporte[data.anzahlTransporte-1];
  console.log("Transport transient angelegt : " + data);

  transportSpeichern(eineNummer);

  //
  // und im Vertrag ergänzen 
  //
  var index = data.tpVertrag.transporte.length;
  data.tpVertrag.transporte[index] = data.derTransport;
  console.log("Transport in den Vertrag geschrieben : " + data); 
}





function transporteFinden(data){

  console.log("Transport zum Vertrag finden...: " );

  //vertrag suchen
  var control=0;
  var max=0;

  max = data.versicherungsvertraege.length;


  for (i = 0; i < max; i++) { 
    console.log("Vertrag suchen : " + data);
    if (data.TransporteFindenID==data.versicherungsvertraege[i].id) {

        data.derVersicherungsvertrag = data.versicherungsvertraege[i] ;
        data.Systeminfo="Vertrag gefunden";
        control=1;
        console.log("Vertrag gefunden: " + data);
    }
  }

  if (control==1){
  
    console.log("Transporte suchen...." + data.derVersicherungsvertrag.id);

    //transporte auslesen
    var max=data.derVersicherungsvertrag.transporte.length;
    if (max==0)
      data.Systeminfo="Vertrag ohne Transport gefunden";
    else
      data.Systeminfo="Vertrag mit " + max + " Transporten gefunden";

    var vertragstransport;
    data.transporte=new Array();
    for (i = 0; i < max; i++) { 
      vertragstransport = data.derVersicherungsvertrag.transporte[i];
      //console.log("Transport des Vertrags gefunden : " + vertragstransport.id);

      data.transporte.push({
        vertrag : vertragstransport.vertrag,
        spedition :  vertragstransport.spedition,
        absender : vertragstransport.absender,
        id : vertragstransport.id,
        warenwert : vertragstransport.warenwert,
        datum : vertragstransport.datum,
        ziel : vertragstransport.ziel,
        schaden : vertragstransport.schaden,
        adresse : " t"
      });
    }
    //console.log(max + " Transporte gefunden.");
    
  } else {
    data.transporte=new Array();
    //data.TransporteFindenADR = "vertrag existiert nicht"
    data.Systeminfo = "Vertrag existiert nicht";
  }


}


/*************************************************
 * 
 * 
 * 2Routen managen
 * 
 * 
 ***************************************************/
function aktualisiereTransportschaeden (data,id, schadenhoehe ) {

  //Transport suchen
  for (i = 0; i < data.transporte.length; i++) { 
    if (data.transporte[i].id == id) {
      var bisher  = data.transporte[i].schaeden;
      var neu = Number(bisher) + Number(schadenhoehe);
      //console.log("aktualisiere schäden:" + bisher + "+" + schadenhoehe + "=" + neu );
      data.transporte[i].schaeden=neu;
      

    }
  }
  

}



 
}

function sucheRouten (data) {

  console.log("Routen zum Transport finden...: " );

  //parameter initialisieren 
  var control=0;
  var max=0;

  //falls überhaupt keine transporte vorhanden - dann abbruch
  try {
    max = data.anzeigenRouten;
  } catch (error) {
    control =0;
    max=0;
    data.routen=new Array();
  }
 



  // die routen suchen
  if (control==0){
  
    console.log("Routen suchen...." + data.derTransportAdresse);

    //transporte auslesen
    var anzahl=data.anzahlRouten;
    if (anzahl==0) {
      data.Systeminfo="Transport ohne Routen gefunden";
      return;
    }
    else {
      data.Systeminfo="Transport mit " + anzahl + " Routen gefunden";
    }

    var transportroute;
    data.routen=new Array();
    for (i = 0; i < anzahl; i++) { 
      
      data.derTransport.gibUebergabe(i,(error, value) => {
        if (error) { console.error(error); }
        if (!error) {

          //return (eineUebergabe.datum, eineUebergabe.ort,eineUebergabe.menge,eineUebergabe.frachtfuehrer,eineUebergabe.schaden);
          var index = data.routen.length;
          transportroute = value;
          data.routen.push({
            nr : index+1,
            datum : value[0],
            ort : value[1],
            menge : value[2],
            frachtfuehrer : value[3],
            schaden : value[4],
            adresse : transportroute.adresse
        
          });
        }

      });


      console.log("Transportroute eingefügt : " + data.routen);

    }
    //console.log(max + " Transporte gefunden.");
    
  } else {
    data.routen=new Array();
    //data.TransporteFindenADR = "vertrag existiert nicht"
    data.Systeminfo = "Transport existiert nicht";
  }


  

 
}



function routeAnlegen (data) {

  console.log("Route Anlegen .. " + data);

  var contractDesc = web3.eth.contract(transportABI);
  var contract = contractDesc.at(data.derTransportAdresse);

  // route im transport ergaenzen
  contract.ergaenzeUebergabe (data.rtDatum, data.rtOrt, data.rtMenge,data.rtFrachtfuehrer,0,(error, value) => {
      if (error) { console.error("Fehler beim Routen anlegen" + error); }
        console.log("Route angelegt! " );    
    });

  console.log("....inititiert !");    

}



/*************************************************
 * 
 * 
 * 5Testdaten managen
 * 
 * 
 ***************************************************/
function ErzeugeTestdaten (data) {

  
  data.dieVersicherung="ruv";
  data.derVersicherungsvertrag="K19";
  data.dieSpedition="sturm gmbh";  


  //transport erstellen
  data.tpSpedition=data.vvVersicherungsnehmer;
  data.tpAbsender=data.absender[index];
  data.tpIdentifikation = "T" + index +"-" + index *67432;
  data.tpWarenwert= index * 1000 + "Euro";
  data.tpZiel = data.staedte[10-index];
  transportAnlegen (data);
  console.log ("Transport 1 angelegt : " + data);

  //transport erstellen
  data.tpSpedition=data.vvVersicherungsnehmer;
  data.tpAbsender=data.absender[index+1];
  data.tpIdentifikation = "T" + index +"-" + index * 5689;
  data.tpWarenwert= index * 5000 + "Euro";
  data.tpZiel = data.staedte[9-index];
  transportAnlegen (data);
  console.log ("Transport 2 angelegt : " + data);

  //routen erstellen
  data.rttransport = data.tpIdentifikation;
  var einTag = Math.round(Math.random() * (24 - 1)) + 1;
  var einMonat = Math.round(Math.random() * (12 - 1)) + 1;
  maxRouten  = Math.round(Math.random() * (5 - 1)) + 1;


  for (i=1;i<maxRouten;i++) {
    console.log ("Route : " + i + "/" + maxRouten  );

    j = i+1;
    k = i+2;
    data.rtVon = data.staedte[i];
    data.rtNach = data.staedte[j];
    data.rtAbfahrt = einTag + i + "." + einMonat + "." + dasJahr ;
    data.rtAnkunft = einTag + i + "." + einMonat + "." + dasJahr ;
    data.rtAdresse = data.staedte[k];

    
    
    if (i >= 4)
      schaden =  Math.round(Math.random() * (5 - 0)) + 0;

    else
      schaden = 0;


    data.rtSchaden = schaden;
    routeAnlegen (data);
    console.log ("Route angelegt : " + i + " " + data);

  } 
  

}

function InitDaten(data){

  /*
  /** Speditionen anlegen
   * 
   */
  data.speditionen[0]="Trucker frank",
  data.speditionen[1]="Trucker thomas",
  data.speditionen[2]="Trucker mischok",
  data.speditionen[3]="Frachtzentrum Linksaußen KG",
  data.speditionen[4]="Frachtzentrum Rechtsaußen KG",
  data.speditionen[5]="Frachtzentrum Mittelstürmer KG",
  data.speditionen[6]="LKW-Verleih Rechtsverteidiger ltm.",
  data.speditionen[7]="LKW-Verleih Linksverteidiger Lmt.",
  data.speditionen[8]="LKW-Verleih Libero KG",
  data.speditionen[9]="LKW-Verleih Torwart KG"
  
  data.absender[0]="Florian Mülller",
  data.absender[1]="Stefan Bell",
  data.absender[2]="Daniel Brosinski",
  data.absender[3]="Alexander Hack",
  data.absender[4]="M Kunde",
  data.absender[5]="Riedle Baku",
  data.absender[6]="Daniel Latza",
  data.absender[7]="Karim Osinowo",
  data.absender[8]="Mateta",
  data.absender[9]="Antony Ujah",

  data.staedte[0]="Kiel",
  data.staedte[1]="ST. Pauli",
  data.staedte[2]="Wolfsburg",
  data.staedte[3]="Hannover",
  data.staedte[4]="Dortmund",
  data.staedte[5]="Mainz",
  data.staedte[6]="Hoffenheim",
  data.staedte[7]="München",
  data.staedte[8]="Wien",
  data.staedte[9]="Mailand"



  console.log("3KD - Transporte erfolgreich")



  /*
  * Routen anlegen
  */
  derTag = "9.";
  derMonat ="10.";
  dasDatum = derTag+derMonat+dasJahr;
  data.derTransport.routen=new Array();
  data.derTransport.routen[0]=data.routen[0];

  data.routen.push (
      {
      id : "R0-8ABEDAA8990" ,  
      transport: data.derTransport,
      //von: data.staedte[1],
      //nach: data.staedte[2],
      von : "Bremen",
      nach : "Göttingen",
      abfahrt: "9.10.2018" ,
      ankunft: "10.10.2018" ,
      schaden : 0,
      adresse : "0x6d8C98f8eb01F8f7ee55D25Bf01e30Fa64333940",
      }
  )


  data.routen.push (
    {
    id : "R1-8EAHGRAAA8990" ,  
    transport: data.derTransport,
    von : "Göttingen",
    nach : "Fulda",
    abfahrt: "10.10.2018" ,
    ankunft: "12.10.2018" ,
    schaden : 0,
    adresse : "0x6d8C98f8eb01F8f7ee55D25Bf01e30Fa64333940",
    }
  )
  data.derTransport.routen[1]=data.routen[1];
  data.routen.push (
      {
      id : "R2-235TZEAAWSE" ,  
      transport: data.derTransport,
      von : "Fulda",
      nach : "Limburg",
      abfahrt: "14.10.2018",
      ankunft: "15.10.2018",
      schaden : 1,
      adresse : "0x6d8C98f8eb01F8f7ee55D25Bf01e30Fa64333940",
      }
  )

  data.derTransport.routen[2]=data.routen[2];
//counter erhöhen
data.anzahlRouten=data.routen.length; 
data.dieRoute=data.routen[1];
console.log("4KD - Routen erfolgreich")


console.log("Konfigurationsdaten erzeugt");
}


function InitTestparameter(data) {


  console.log("Parameter erzeugen");
  var step=0;
  var max;
  max=1000000;
  i = Math.round(Math.random() * (max - 1)) + 1;
 
  try {

    /*
      max=20000; 
      i = Math.round(Math.random() * (max - 1)) + 1;
      data.dieSpedition=data.versicherungsnehmer[i];*/
      data.dieSpedition="sturm gmbh";
    
      /*
      /* parameter für transporte vorbelegen
      */
      step=1;
      max = data.speditionen.length-1;
      i = Math.round(Math.random() * (max - 1)) + 1;
      data.tpSpedition=data.speditionen[i];
      
      max =data.absender.length;
      i = Math.round(Math.random() * (max - 1)) + 1;
      data.tpAbsender=data.absender[i];

      max = data.staedte.length;
      i = Math.round(Math.random() * (max - 1)) + 1;
      data.tpZiel = data.staedte[10-i];
      
      data.tpWarenwert= i * 1000 + " Euro";

      i = Math.round(Math.random() * (30 - 1)) + 1;
      data.tpDatum = i + ".6.2018";
      

      //routen parameter
      step=2;
      max = data.transporte.length-1;
      i = Math.round(Math.random() * (max - 1)) + 1;
      data.rtTransport=data.transporte[i];

      max = data.staedte.length;
      i = Math.round(Math.random() * (max - 1)) + 1;
      data.rtVon = data.staedte[i];
      max = data.staedte.length;
      i = Math.round(Math.random() * (max - 1)) + 1;
      data.rtNach = data.staedte[i];
      i = Math.round(Math.random() * (22 - 1)) + 1;
      data.rtAbfahrt = i + ".9.2018";
      i=i+3;
      data.rtAnkunft = i + ".9.2018";
      max = data.staedte.length-1;
      i = Math.round(Math.random() * (max - 1)) + 1;
      data.rtVon = data.staedte[i];
      i = Math.round(Math.random() * (max - 1)) + 1;
      data.rtNach = data.staedte[i];

      i = Math.round(Math.random() * (3 - 1)) + 1;
      data.rtSchaden =  i;

      /*if (i == 3)
        schaden ="ja";
      else
        schaden = "nein";*/

      console.log("Parameter vorbelegen erfolgreich." + step);
  

    
  } catch (error) {

    console.log("Parameter vorbelegen mit Fehler: " + error);


  }
 

  
  console.log("Parameter erzeugen abgeschlossen: " + data);
}

function InitTransaktion (data) {

  data.trInfo1="Versicherung: " + data.bcVersicherung;
  data.trInfo2="Spedition: " + data.bcSpedition;
  data.trInfo3="Gas: " + fgDefaultGas;
  data.trInfo4="Manager: " + bcManager;


}

function seiteVor (data) {
  //https://www.google.de/maps/dir/Hamburg/Hannover/Wolfsburg
  var strecke="";
  var url ="https://www.google.de/maps/dir";

  for (let index = 0; index <data.routen.length; index++) {
    strecke = strecke + "/" + data.routen[index].ort;
  }

  link=url+strecke; 
  console.log(link);
  window.open(link);

}


function uebergabeAnzeigen(data) {

switch (data.rtNr) {
  case 3:
    link="transportschaden" + data.rtNr + ".jpg"; 
    window.open(link);    
    break;
  case 5:
    link="transportschaden" + data.rtNr + ".jpg"; 
    window.open(link);    
    break;
  case 6:
    link="transportschaden" + data.rtNr + ".jpg"; 
    window.open(link);    
    break;
            
  default:
    data.Systeminfo="<<<< keine Details gefunden zu Uebegabe " + data.rtNr + " gefunden.";
    break;
}



}



/*************************************************
 * 
 * 
 * Startseite aufrufen
 * 
 * 
 ***************************************************/
function initVue() {
  const data = {

    /* Listen */
    
    versicherungsvertraege: [],
    anzahlVertraege: "0",

    speditionen: [],
    anzahlSpeditionen: "0",

    transporte: [],
    anzahlTransporte: "0",

    routen: [],
    anzahlRouten: "0",

    absender: [],
    anzahlAbsender: "0",

    staedte: [],


    // system
    bcPrototypVersion :"",
    bcManager : "",
    bcSpedition : "",
    bcVersicherung : "",
    trInfo1 :"", 
    trInfo2 :"", 
    trInfo3 :"", 
    trInfo4 :"",

    
    RoutenFindenID: "transport-id",

    /* Objekte */
    spName : "name",

    tpAbsenderName : "wer",
    tpAbsenderDatum : "wann",
    tpAbsenderOrt : "wohin",

    tpAdressatName : "an",
    tpAdressatDatum : "am",
    tpAdressatOrt : "nach",

    tpSpedition : "spedition",
    tpWarenwert: "warenwert",
    tpMenge: "menge",
    tpEinheit : "einheit",
    tpArt : "was",
    tpIdentifikation: "id",
    tpAdresse : "adresse",
    tpSchaeden : "",
    
    rtNr : "",
    rtFrachtfuehrer : "",
    rtTransport : "",
    rtOrt : "",
    rtDatum : "",
    rtMenge : "",
    rtSchaden : "",
    rtAdresse : "",
   

    /** aktuelle Objekte */
    dieKooperation : "",
    dieKooperationName : "",
    dieKooperationAdresse : "",
    dieVersicherung : "",
    derVersicherungsvertrag : "",
    derVersicherungsvertragAdresse : "",
    derVersicherungsvertragName : "",
    derTransport : "",
    derTransportAdresse : "",
    dieRoute : "",
    
    /* sonstiges */
    zufallszahl : 1,
    Systeminfo : "",

  };
  new Vue({
    el: '#app',
    data: data,
    methods: {


      TransportAuswaehlen(adresse) {
        data.tpAdresse=adresse;
        anzeigenTransport(data);
      },

      TransportAnzeigen() {
        anzeigenTransport(data,1);
      },

      TransportAendern() {
        anzeigenTransport(data);
      },

      TransportAnlegen() {
        transportAnlegen(data);
      },

      TransporteFinden() {
        sucheTransporte(data);
      },
      TransportAbrechnen(){
        transportAbrechnen(data);
      },

      RouteAendern(){
        
        //routeAnlegen(data);

      }, 

      RoutenSuchen(){
        sucheRouten(data);

      },

      RouteAnlegen(){
        routeAnlegen(data);

      },

      SchadenMelden() {
        meldenSchaden(data);
      },

      RoutenAnzeigen() {
        seiteVor(data);
      },



      RouteAuswaehlen(auswahl) {
        var nr=1000;
        nr = auswahl-1;
        data.rtNr = auswahl;
        data.rtFrachtfuehrer = data.routen[nr].frachtfuehrer;
        data.rtOrt = data.routen[nr].ort;
        data.rtDatum = data.routen[nr].datum;
        data.rtMenge = data.routen[nr].menge;
        data.rtSchaden = data.routen[nr].schaden;

      },


      UebergabeAnzeigen() {
        uebergabeAnzeigen(data);
      },
      
      EingabefelderInitialisieren() {
        InitTestparameter(data);
      },

      TestdatenErzeugen() {
        ErzeugeTestdaten(data);
      }

    }
  });

  data.bcPrototypVersion = bcPrototypVersion;
  data.bcManager = bcManager;
  data.bcSpedition = bcSpedition;
  data.bcVersicherung = bcVersicherung;

  data.dieKooperationAdresse=kooperationContractADR;
  data.dieKooperationName=kooperationName;
  data.derVersicherungsvertragAdresse=versicherungsvertragContractADR;
  data.derVersicherungsvertragName=versicherungsvertragName;
  sucheVersicherungsvertrag(data);
  //InitTransaktion(data);
  //InitDaten(data);
  
  data.TransporteFindenID="0xec7d0207ff89e6dc741231a49c5bf20c02ca8d4b";
  console.log("Initialisierung abgeschlossen");
  

}